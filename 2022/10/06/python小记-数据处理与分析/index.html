<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
	<link rel="dns-prefetch" href="//cdn.bootcss.com" />
	<link rel="dns-prefetch" href="//cdn.mathjax.org" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Caaaaa">
    
    <title>
        
            数据预处理 |
        
        Caaaaa
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.png">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":false,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/logo.png","favicon":"/images/logo.png","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"To be a slash youth."},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":false,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Caaaaa
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">CATEGORIES</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">数据预处理</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/logo.png">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Caaaaa</span>
                        
                            <span class="author-label">Lv5</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2022-10-06 20:08:30</span>
        <span class="mobile">2022-10-06 20:08</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/python%E5%B0%8F%E8%AE%B0/">python小记</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>6.1k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>36 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h2 id="定义分析的问题">定义分析的问题</h2>
<p><img src="/img/sjycl.png" /></p>
<h2 id="理解数据">理解数据</h2>
<h3 id="导入数据">导入数据</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> asz</span><br><span class="line"><span class="keyword">from</span> plotly.subplots <span class="keyword">import</span> make_subplots</span><br><span class="line"><span class="keyword">import</span> plotly.graph_objs <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">path = <span class="string">&quot;anonymized_full_release_competition_dataset.csv&quot;</span></span><br><span class="line">data = pd.read_csv(path, encoding = <span class="string">&quot;ISO-8859-15&quot;</span>,low_memory=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<h3 id="查看数据集信息">查看数据集信息</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="number">500</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
studentId
</th>
<th>
MiddleSchoolId
</th>
<th>
InferredGender
</th>
<th>
SY ASSISTments Usage
</th>
<th>
AveKnow
</th>
<th>
AveCarelessness
</th>
<th>
AveCorrect
</th>
<th>
NumActions
</th>
<th>
AveResBored
</th>
<th>
AveResEngcon
</th>
<th>
AveResConf
</th>
<th>
AveResFrust
</th>
<th>
AveResOfftask
</th>
<th>
AveResGaming
</th>
<th>
action_num
</th>
<th>
skill
</th>
<th>
problemId
</th>
<th>
problemType
</th>
<th>
assignmentId
</th>
<th>
assistmentId
</th>
<th>
startTime
</th>
<th>
endTime
</th>
<th>
timeTaken
</th>
<th>
correct
</th>
<th>
original
</th>
<th>
hint
</th>
<th>
hintCount
</th>
<th>
hintTotal
</th>
<th>
scaffold
</th>
<th>
bottomHint
</th>
<th>
attemptCount
</th>
<th>
frIsHelpRequest
</th>
<th>
frPast5HelpRequest
</th>
<th>
frPast8HelpRequest
</th>
<th>
stlHintUsed
</th>
<th>
past8BottomOut
</th>
<th>
totalFrPercentPastWrong
</th>
<th>
totalFrPastWrongCount
</th>
<th>
frPast5WrongCount
</th>
<th>
frPast8WrongCount
</th>
<th>
totalFrTimeOnSkill
</th>
<th>
timeSinceSkill
</th>
<th>
frWorkingInSchool
</th>
<th>
totalFrAttempted
</th>
<th>
totalFrSkillOpportunities
</th>
<th>
responseIsFillIn
</th>
<th>
responseIsChosen
</th>
<th>
endsWithScaffolding
</th>
<th>
endsWithAutoScaffolding
</th>
<th>
frTimeTakenOnScaffolding
</th>
<th>
frTotalSkillOpportunitiesScaffolding
</th>
<th>
totalFrSkillOpportunitiesByScaffolding
</th>
<th>
frIsHelpRequestScaffolding
</th>
<th>
timeGreater5Secprev2wrong
</th>
<th>
sumRight
</th>
<th>
helpAccessUnder2Sec
</th>
<th>
timeGreater10SecAndNextActionRight
</th>
<th>
consecutiveErrorsInRow
</th>
<th>
sumTime3SDWhen3RowRight
</th>
<th>
sumTimePerSkill
</th>
<th>
totalTimeByPercentCorrectForskill
</th>
<th>
Prev5count
</th>
<th>
timeOver80
</th>
<th>
manywrong
</th>
<th>
confidence(BORED)
</th>
<th>
confidence(CONCENTRATING)
</th>
<th>
confidence(CONFUSED)
</th>
<th>
confidence(FRUSTRATED)
</th>
<th>
confidence(OFF TASK)
</th>
<th>
confidence(GAMING)
</th>
<th>
RES_BORED
</th>
<th>
RES_CONCENTRATING
</th>
<th>
RES_CONFUSED
</th>
<th>
RES_FRUSTRATED
</th>
<th>
RES_OFFTASK
</th>
<th>
RES_GAMING
</th>
<th>
Ln-1
</th>
<th>
Ln
</th>
<th>
MCAS
</th>
<th>
Enrolled
</th>
<th>
Selective
</th>
<th>
isSTEM
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
8
</td>
<td>
2
</td>
<td>
Male
</td>
<td>
2004-2005
</td>
<td>
0.352416
</td>
<td>
0.183276
</td>
<td>
0.483902
</td>
<td>
1056
</td>
<td>
0.208389
</td>
<td>
0.679126
</td>
<td>
0.115905
</td>
<td>
0.112408
</td>
<td>
0.156503
</td>
<td>
0.196561
</td>
<td>
9950
</td>
<td>
properties-of-geometric-figures
</td>
<td>
1118
</td>
<td>
textfieldquestion
</td>
<td>
20405010
</td>
<td>
104051118
</td>
<td>
1096470301
</td>
<td>
1096470350
</td>
<td>
49.0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
49.0
</td>
<td>
0.000000
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.597865
</td>
<td>
0.234294
</td>
<td>
0.0000
</td>
<td>
0.0
</td>
<td>
0.838710
</td>
<td>
0.008522
</td>
<td>
0.376427
</td>
<td>
0.320317
</td>
<td>
0.000000
</td>
<td>
0.0
</td>
<td>
0.785585
</td>
<td>
0.000264
</td>
<td>
0.13
</td>
<td>
0.061190409
</td>
<td>
45
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
1
</th>
<td>
8
</td>
<td>
2
</td>
<td>
Male
</td>
<td>
2004-2005
</td>
<td>
0.352416
</td>
<td>
0.183276
</td>
<td>
0.483902
</td>
<td>
1056
</td>
<td>
0.208389
</td>
<td>
0.679126
</td>
<td>
0.115905
</td>
<td>
0.112408
</td>
<td>
0.156503
</td>
<td>
0.196561
</td>
<td>
9951
</td>
<td>
properties-of-geometric-figures
</td>
<td>
1119
</td>
<td>
noprobtype
</td>
<td>
20405010
</td>
<td>
104051119
</td>
<td>
1096470350
</td>
<td>
1096470354
</td>
<td>
4.0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
49.0
</td>
<td>
0.0
</td>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
4.0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
53.0
</td>
<td>
106.000000
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.355694
</td>
<td>
0.992585
</td>
<td>
0.9375
</td>
<td>
0.0
</td>
<td>
0.600000
</td>
<td>
0.047821
</td>
<td>
0.156027
</td>
<td>
0.995053
</td>
<td>
0.887452
</td>
<td>
0.0
</td>
<td>
0.468252
</td>
<td>
0.001483
</td>
<td>
0.061190409
</td>
<td>
0.213509945
</td>
<td>
45
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
2
</th>
<td>
8
</td>
<td>
2
</td>
<td>
Male
</td>
<td>
2004-2005
</td>
<td>
0.352416
</td>
<td>
0.183276
</td>
<td>
0.483902
</td>
<td>
1056
</td>
<td>
0.208389
</td>
<td>
0.679126
</td>
<td>
0.115905
</td>
<td>
0.112408
</td>
<td>
0.156503
</td>
<td>
0.196561
</td>
<td>
9952
</td>
<td>
sum-of-interior-angles-more-than-3-sides
</td>
<td>
1120
</td>
<td>
noprobtype
</td>
<td>
20405010
</td>
<td>
104051120
</td>
<td>
1096470354
</td>
<td>
1096470360
</td>
<td>
6.0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
1
</td>
<td>
2
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
6.0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
6.0
</td>
<td>
0.000000
</td>
<td>
2
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.355694
</td>
<td>
0.992585
</td>
<td>
0.9375
</td>
<td>
0.0
</td>
<td>
0.600000
</td>
<td>
0.047821
</td>
<td>
0.156027
</td>
<td>
0.995053
</td>
<td>
0.887452
</td>
<td>
0.0
</td>
<td>
0.468252
</td>
<td>
0.001483
</td>
<td>
0.116
</td>
<td>
0.033305768
</td>
<td>
45
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
8
</td>
<td>
2
</td>
<td>
Male
</td>
<td>
2004-2005
</td>
<td>
0.352416
</td>
<td>
0.183276
</td>
<td>
0.483902
</td>
<td>
1056
</td>
<td>
0.208389
</td>
<td>
0.679126
</td>
<td>
0.115905
</td>
<td>
0.112408
</td>
<td>
0.156503
</td>
<td>
0.196561
</td>
<td>
9953
</td>
<td>
sum-of-interior-angles-more-than-3-sides
</td>
<td>
1120
</td>
<td>
noprobtype
</td>
<td>
20405010
</td>
<td>
104051120
</td>
<td>
1096470360
</td>
<td>
1096470378
</td>
<td>
18.0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
0.0
</td>
<td>
1
</td>
<td>
3
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
6.0
</td>
<td>
1
</td>
<td>
0.0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.0
</td>
<td>
24.0
</td>
<td>
0.000000
</td>
<td>
3
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0.355694
</td>
<td>
0.617065
</td>
<td>
0.0000
</td>
<td>
0.0
</td>
<td>
0.204082
</td>
<td>
0.343996
</td>
<td>
0.156027
</td>
<td>
0.744520
</td>
<td>
0.000000
</td>
<td>
0.0
</td>
<td>
0.108417
</td>
<td>
0.010665
</td>
<td>
0.116
</td>
<td>
0.033305768
</td>
<td>
45
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
8
</td>
<td>
2
</td>
<td>
Male
</td>
<td>
2004-2005
</td>
<td>
0.352416
</td>
<td>
0.183276
</td>
<td>
0.483902
</td>
<td>
1056
</td>
<td>
0.208389
</td>
<td>
0.679126
</td>
<td>
0.115905
</td>
<td>
0.112408
</td>
<td>
0.156503
</td>
<td>
0.196561
</td>
<td>
9954
</td>
<td>
sum-of-interior-angles-more-than-3-sides
</td>
<td>
1121
</td>
<td>
noprobtype
</td>
<td>
20405010
</td>
<td>
104051121
</td>
<td>
1096470378
</td>
<td>
1096470380
</td>
<td>
2.0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
1.0
</td>
<td>
1
</td>
<td>
1
</td>
<td>
1
</td>
<td>
6.0
</td>
<td>
0.0
</td>
<td>
1
</td>
<td>
3
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
2.0
</td>
<td>
1
</td>
<td>
1.0
</td>
<td>
0
</td>
<td>
0
</td>
<td>
2
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0
</td>
<td>
0.0
</td>
<td>
26.0
</td>
<td>
77.999999
</td>
<td>
4
</td>
<td>
0
</td>
<td>
1
</td>
<td>
0.355694
</td>
<td>
0.617065
</td>
<td>
0.0000
</td>
<td>
0.0
</td>
<td>
0.204082
</td>
<td>
0.343996
</td>
<td>
0.156027
</td>
<td>
0.744520
</td>
<td>
0.000000
</td>
<td>
0.0
</td>
<td>
0.108417
</td>
<td>
0.010665
</td>
<td>
0.033305768
</td>
<td>
0.118385889
</td>
<td>
45
</td>
<td>
0
</td>
<td>
0
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
</div>
<h4 id="常见指标">常见指标</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.describe()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
studentId
</th>
<th>
MiddleSchoolId
</th>
<th>
AveKnow
</th>
<th>
AveCarelessness
</th>
<th>
AveCorrect
</th>
<th>
NumActions
</th>
<th>
AveResBored
</th>
<th>
AveResEngcon
</th>
<th>
AveResConf
</th>
<th>
AveResFrust
</th>
<th>
AveResOfftask
</th>
<th>
AveResGaming
</th>
<th>
action_num
</th>
<th>
problemId
</th>
<th>
assignmentId
</th>
<th>
assistmentId
</th>
<th>
startTime
</th>
<th>
endTime
</th>
<th>
timeTaken
</th>
<th>
correct
</th>
<th>
original
</th>
<th>
hint
</th>
<th>
hintCount
</th>
<th>
hintTotal
</th>
<th>
scaffold
</th>
<th>
bottomHint
</th>
<th>
attemptCount
</th>
<th>
frIsHelpRequest
</th>
<th>
frPast5HelpRequest
</th>
<th>
frPast8HelpRequest
</th>
<th>
stlHintUsed
</th>
<th>
past8BottomOut
</th>
<th>
totalFrPercentPastWrong
</th>
<th>
totalFrPastWrongCount
</th>
<th>
frPast5WrongCount
</th>
<th>
frPast8WrongCount
</th>
<th>
totalFrTimeOnSkill
</th>
<th>
timeSinceSkill
</th>
<th>
frWorkingInSchool
</th>
<th>
totalFrAttempted
</th>
<th>
totalFrSkillOpportunities
</th>
<th>
responseIsFillIn
</th>
<th>
responseIsChosen
</th>
<th>
endsWithScaffolding
</th>
<th>
endsWithAutoScaffolding
</th>
<th>
frTimeTakenOnScaffolding
</th>
<th>
frTotalSkillOpportunitiesScaffolding
</th>
<th>
totalFrSkillOpportunitiesByScaffolding
</th>
<th>
frIsHelpRequestScaffolding
</th>
<th>
timeGreater5Secprev2wrong
</th>
<th>
sumRight
</th>
<th>
helpAccessUnder2Sec
</th>
<th>
timeGreater10SecAndNextActionRight
</th>
<th>
consecutiveErrorsInRow
</th>
<th>
sumTime3SDWhen3RowRight
</th>
<th>
sumTimePerSkill
</th>
<th>
totalTimeByPercentCorrectForskill
</th>
<th>
Prev5count
</th>
<th>
timeOver80
</th>
<th>
manywrong
</th>
<th>
confidence(BORED)
</th>
<th>
confidence(CONCENTRATING)
</th>
<th>
confidence(CONFUSED)
</th>
<th>
confidence(FRUSTRATED)
</th>
<th>
confidence(OFF TASK)
</th>
<th>
confidence(GAMING)
</th>
<th>
RES_BORED
</th>
<th>
RES_CONCENTRATING
</th>
<th>
RES_CONFUSED
</th>
<th>
RES_FRUSTRATED
</th>
<th>
RES_OFFTASK
</th>
<th>
RES_GAMING
</th>
<th>
MCAS
</th>
<th>
Enrolled
</th>
<th>
Selective
</th>
<th>
isSTEM
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
count
</th>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
9.428160e+05
</td>
<td>
942816.000000
</td>
<td>
9.428160e+05
</td>
<td>
9.428160e+05
</td>
<td>
9.428160e+05
</td>
<td>
9.428160e+05
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
9.428160e+05
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.0
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942731.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
9.428160e+05
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
9.428160e+05
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
942816.000000
</td>
<td>
316974.000000
</td>
</tr>
<tr>
<th>
mean
</th>
<td>
3844.844105
</td>
<td>
2.515472
</td>
<td>
0.195155
</td>
<td>
0.109436
</td>
<td>
0.372681
</td>
<td>
869.850594
</td>
<td>
0.232949
</td>
<td>
0.658442
</td>
<td>
0.098940
</td>
<td>
0.131406
</td>
<td>
0.172212
</td>
<td>
0.192703
</td>
<td>
1.849329e+06
</td>
<td>
1899.719319
</td>
<td>
1.198773e+07
</td>
<td>
6.061572e+07
</td>
<td>
1.120793e+09
</td>
<td>
1.120793e+09
</td>
<td>
29.747869
</td>
<td>
0.372681
</td>
<td>
0.264214
</td>
<td>
0.331025
</td>
<td>
1.218490
</td>
<td>
1.953967
</td>
<td>
0.385732
</td>
<td>
0.062794
</td>
<td>
2.673605
</td>
<td>
0.268104
</td>
<td>
1.947322
</td>
<td>
2.575323
</td>
<td>
0.004012
</td>
<td>
0.241678
</td>
<td>
0.227882
</td>
<td>
1.988008
</td>
<td>
0.719380
</td>
<td>
0.944750
</td>
<td>
376.213405
</td>
<td>
4.850802e+05
</td>
<td>
0.974588
</td>
<td>
193.316005
</td>
<td>
8.381019
</td>
<td>
0.023131
</td>
<td>
0.0
</td>
<td>
0.636085
</td>
<td>
0.005724
</td>
<td>
24.060853
</td>
<td>
3.989371
</td>
<td>
1.036189
</td>
<td>
0.670047
</td>
<td>
0.045388
</td>
<td>
145.982059
</td>
<td>
0.055674
</td>
<td>
0.207414
</td>
<td>
0.155307
</td>
<td>
0.087042
</td>
<td>
601.665586
</td>
<td>
2166.143744
</td>
<td>
4.972689
</td>
<td>
0.081323
</td>
<td>
0.715638
</td>
<td>
0.436958
</td>
<td>
5.400894e-01
</td>
<td>
0.134450
</td>
<td>
0.164114
</td>
<td>
0.256006
</td>
<td>
0.337888
</td>
<td>
0.232949
</td>
<td>
6.584415e-01
</td>
<td>
0.098940
</td>
<td>
0.131406
</td>
<td>
0.172212
</td>
<td>
0.192703
</td>
<td>
-95.982302
</td>
<td>
0.641147
</td>
<td>
0.300434
</td>
<td>
0.204178
</td>
</tr>
<tr>
<th>
std
</th>
<td>
2250.484065
</td>
<td>
1.039785
</td>
<td>
0.116451
</td>
<td>
0.059952
</td>
<td>
0.107367
</td>
<td>
530.210725
</td>
<td>
0.030637
</td>
<td>
0.027440
</td>
<td>
0.034788
</td>
<td>
0.038875
</td>
<td>
0.057992
</td>
<td>
0.153455
</td>
<td>
1.726001e+06
</td>
<td>
2579.212724
</td>
<td>
1.434706e+07
</td>
<td>
5.128829e+07
</td>
<td>
1.940359e+07
</td>
<td>
1.940354e+07
</td>
<td>
72.019768
</td>
<td>
0.483519
</td>
<td>
0.440914
</td>
<td>
0.470582
</td>
<td>
1.980665
</td>
<td>
2.929242
</td>
<td>
0.486768
</td>
<td>
0.242592
</td>
<td>
2.929801
</td>
<td>
0.442972
</td>
<td>
1.712580
</td>
<td>
2.457799
</td>
<td>
0.063217
</td>
<td>
0.674613
</td>
<td>
0.271404
</td>
<td>
3.390149
</td>
<td>
0.832699
</td>
<td>
1.076276
</td>
<td>
689.302924
</td>
<td>
2.075599e+06
</td>
<td>
0.157373
</td>
<td>
164.898869
</td>
<td>
11.998292
</td>
<td>
0.150319
</td>
<td>
0.0
</td>
<td>
0.481125
</td>
<td>
0.075443
</td>
<td>
71.665655
</td>
<td>
6.581897
</td>
<td>
1.184489
</td>
<td>
0.470196
</td>
<td>
0.208155
</td>
<td>
124.342503
</td>
<td>
0.229291
</td>
<td>
0.405455
</td>
<td>
0.885692
</td>
<td>
1.619202
</td>
<td>
953.900687
</td>
<td>
4601.435964
</td>
<td>
0.315281
</td>
<td>
0.273331
</td>
<td>
0.451110
</td>
<td>
0.120751
</td>
<td>
1.830483e-01
</td>
<td>
0.292877
</td>
<td>
0.326057
</td>
<td>
0.213177
</td>
<td>
0.335292
</td>
<td>
0.116371
</td>
<td>
1.734275e-01
</td>
<td>
0.249505
</td>
<td>
0.300351
</td>
<td>
0.216997
</td>
<td>
0.340232
</td>
<td>
332.827628
</td>
<td>
0.479664
</td>
<td>
0.458447
</td>
<td>
0.403100
</td>
</tr>
<tr>
<th>
min
</th>
<td>
8.000000
</td>
<td>
1.000000
</td>
<td>
0.028057
</td>
<td>
0.007801
</td>
<td>
0.000000
</td>
<td>
2.000000
</td>
<td>
0.170871
</td>
<td>
0.403309
</td>
<td>
0.005075
</td>
<td>
0.000000
</td>
<td>
0.083167
</td>
<td>
0.001974
</td>
<td>
9.950000e+03
</td>
<td>
1.000000
</td>
<td>
2.000000e+00
</td>
<td>
5.000000e+00
</td>
<td>
1.095421e+09
</td>
<td>
1.095421e+09
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
-9.928014e+06
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.0
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
-11.332080
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.355694
</td>
<td>
6.500000e-07
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000039
</td>
<td>
0.156027
</td>
<td>
8.890000e-07
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000001
</td>
<td>
-999.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
</tr>
<tr>
<th>
25%
</th>
<td>
1952.000000
</td>
<td>
2.000000
</td>
<td>
0.110542
</td>
<td>
0.068760
</td>
<td>
0.294989
</td>
<td>
478.000000
</td>
<td>
0.209035
</td>
<td>
0.642060
</td>
<td>
0.076385
</td>
<td>
0.107278
</td>
<td>
0.131467
</td>
<td>
0.060724
</td>
<td>
7.221708e+05
</td>
<td>
721.000000
</td>
<td>
7.230000e+02
</td>
<td>
2.213000e+03
</td>
<td>
1.103136e+09
</td>
<td>
1.103136e+09
</td>
<td>
5.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
37.000000
</td>
<td>
0.000000e+00
</td>
<td>
1.000000
</td>
<td>
67.000000
</td>
<td>
2.000000
</td>
<td>
0.000000
</td>
<td>
0.0
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
50.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
107.000000
</td>
<td>
189.736571
</td>
<td>
5.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.355694
</td>
<td>
3.743169e-01
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.090909
</td>
<td>
0.047821
</td>
<td>
0.156027
</td>
<td>
5.117519e-01
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.048295
</td>
<td>
0.001483
</td>
<td>
14.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
</tr>
<tr>
<th>
50%
</th>
<td>
3766.000000
</td>
<td>
2.000000
</td>
<td>
0.159285
</td>
<td>
0.094513
</td>
<td>
0.345575
</td>
<td>
754.000000
</td>
<td>
0.230394
</td>
<td>
0.660669
</td>
<td>
0.096357
</td>
<td>
0.127504
</td>
<td>
0.159598
</td>
<td>
0.156245
</td>
<td>
9.578745e+05
</td>
<td>
1116.000000
</td>
<td>
2.040501e+07
</td>
<td>
1.040504e+08
</td>
<td>
1.112980e+09
</td>
<td>
1.112980e+09
</td>
<td>
11.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
2.000000
</td>
<td>
0.000000
</td>
<td>
2.000000
</td>
<td>
2.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.166667
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
140.000000
</td>
<td>
0.000000e+00
</td>
<td>
1.000000
</td>
<td>
151.000000
</td>
<td>
4.000000
</td>
<td>
0.000000
</td>
<td>
0.0
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
8.000000
</td>
<td>
2.000000
</td>
<td>
1.176471
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
113.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
275.000000
</td>
<td>
840.000006
</td>
<td>
5.000000
</td>
<td>
0.000000
</td>
<td>
1.000000
</td>
<td>
0.355694
</td>
<td>
5.676439e-01
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.230769
</td>
<td>
0.186970
</td>
<td>
0.156027
</td>
<td>
7.115475e-01
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.122595
</td>
<td>
0.005797
</td>
<td>
23.000000
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
</tr>
<tr>
<th>
75%
</th>
<td>
5781.000000
</td>
<td>
4.000000
</td>
<td>
0.247704
</td>
<td>
0.137316
</td>
<td>
0.428822
</td>
<td>
1151.000000
</td>
<td>
0.252082
</td>
<td>
0.676588
</td>
<td>
0.119282
</td>
<td>
0.150582
</td>
<td>
0.198533
</td>
<td>
0.298914
</td>
<td>
2.722813e+06
</td>
<td>
1419.000000
</td>
<td>
2.040510e+07
</td>
<td>
1.040511e+08
</td>
<td>
1.138371e+09
</td>
<td>
1.138371e+09
</td>
<td>
30.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
2.000000
</td>
<td>
3.000000
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
3.000000
</td>
<td>
1.000000
</td>
<td>
3.000000
</td>
<td>
4.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.333333
</td>
<td>
2.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
396.000000
</td>
<td>
8.000000e+00
</td>
<td>
1.000000
</td>
<td>
276.000000
</td>
<td>
10.000000
</td>
<td>
0.000000
</td>
<td>
0.0
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
23.000000
</td>
<td>
5.000000
</td>
<td>
1.656250
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
<td>
210.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
0.000000
</td>
<td>
669.000001
</td>
<td>
2404.499998
</td>
<td>
5.000000
</td>
<td>
0.000000
</td>
<td>
1.000000
</td>
<td>
0.597865
</td>
<td>
6.591692e-01
</td>
<td>
0.000000
</td>
<td>
0.091463
</td>
<td>
0.230769
</td>
<td>
0.614582
</td>
<td>
0.376427
</td>
<td>
7.726099e-01
</td>
<td>
0.000000
</td>
<td>
0.009561
</td>
<td>
0.122595
</td>
<td>
0.259648
</td>
<td>
34.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
0.000000
</td>
</tr>
<tr>
<th>
max
</th>
<td>
7783.000000
</td>
<td>
4.000000
</td>
<td>
0.752498
</td>
<td>
0.430576
</td>
<td>
0.932990
</td>
<td>
3057.000000
</td>
<td>
0.440870
</td>
<td>
0.723990
</td>
<td>
0.402483
</td>
<td>
0.543463
</td>
<td>
0.837402
</td>
<td>
0.709200
</td>
<td>
6.355811e+06
</td>
<td>
22761.000000
</td>
<td>
1.000000e+09
</td>
<td>
1.040515e+08
</td>
<td>
1.180218e+09
</td>
<td>
1.180218e+09
</td>
<td>
9999.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
56.000000
</td>
<td>
56.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
91.000000
</td>
<td>
1.000000
</td>
<td>
5.000000
</td>
<td>
8.000000
</td>
<td>
1.000000
</td>
<td>
8.000000
</td>
<td>
1.000000
</td>
<td>
73.000000
</td>
<td>
5.000000
</td>
<td>
8.000000
</td>
<td>
11663.000000
</td>
<td>
4.840000e+07
</td>
<td>
1.000000
</td>
<td>
1378.000000
</td>
<td>
221.000000
</td>
<td>
1.000000
</td>
<td>
0.0
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
9999.000000
</td>
<td>
105.000000
</td>
<td>
37.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
962.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
56.000000
</td>
<td>
92.709045
</td>
<td>
12459.000000
</td>
<td>
310590.000100
</td>
<td>
5.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
0.680982
</td>
<td>
1.000000e+00
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
0.999676
</td>
<td>
0.505313
</td>
<td>
1.000000e+00
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
0.999377
</td>
<td>
54.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
</tr>
</tbody>
</table>
</div>
<h4 id="不重复的记录数">不重复的记录数</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;The number of records: &quot;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>(data[<span class="string">&#x27;action_num&#x27;</span>].unique())))</span><br><span class="line"><span class="comment">#or use print(data[&#x27;action_num&#x27;].count())</span></span><br></pre></td></tr></table></figure>
<pre><code>The number of records: 942816</code></pre>
<h4 id="每一类的缺失值比例">每一类的缺失值比例</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Part of missing values for every column&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data.isnull().<span class="built_in">sum</span>() / <span class="built_in">len</span>(data))</span><br></pre></td></tr></table></figure>
<pre><code>Part of missing values for every column
studentId               0.000000
MiddleSchoolId          0.000000
InferredGender          0.184189
SY ASSISTments Usage    0.000000
AveKnow                 0.000000
                          ...   
Ln                      0.000000
MCAS                    0.000000
Enrolled                0.000000
Selective               0.000000
isSTEM                  0.663801
Length: 82, dtype: float64</code></pre>
<h4 id="不重复的学生数">不重复的学生数</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(data.studentId.unique())</span><br></pre></td></tr></table></figure>
<pre><code>1709</code></pre>
<h4 id="不重复的学校数">不重复的学校数</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(data.MiddleSchoolId.unique())</span><br></pre></td></tr></table></figure>
<pre><code>4</code></pre>
<h4 id="做题记录最多的学生">做题记录最多的学生</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">ds = data[<span class="string">&#x27;studentId&#x27;</span>].value_counts().reset_index() <span class="comment">#value_counts以后studentid是index，需要reset</span></span><br><span class="line"></span><br><span class="line">ds.columns = [</span><br><span class="line">    <span class="string">&#x27;studentId&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;count&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">ds[<span class="string">&#x27;studentId&#x27;</span>] = ds[<span class="string">&#x27;studentId&#x27;</span>].astype(<span class="built_in">str</span>) + <span class="string">&#x27;-&#x27;</span> <span class="comment">#将数据转成str类。否则纵坐标出错</span></span><br><span class="line">ds = ds.sort_values([<span class="string">&#x27;count&#x27;</span>]).tail(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">fig = px.bar(</span><br><span class="line">    ds,</span><br><span class="line">    x = <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">    y = <span class="string">&#x27;studentId&#x27;</span>,</span><br><span class="line">    orientation=<span class="string">&#x27;h&#x27;</span>,</span><br><span class="line">    title=<span class="string">&#x27;Top 40 students by number of actions&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show(<span class="string">&quot;svg&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/img/output_18_0.svg" /></p>
<h4 id="每个学生的做题数">每个学生的做题数</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ds = data[<span class="string">&#x27;studentId&#x27;</span>].value_counts().reset_index()</span><br><span class="line"></span><br><span class="line">ds.columns = [</span><br><span class="line">    <span class="string">&#x27;studentId&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;count&#x27;</span></span><br><span class="line">]</span><br><span class="line"><span class="comment">## Correct answers</span></span><br><span class="line">ds = ds.sort_values(<span class="string">&#x27;studentId&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fig = px.histogram(</span><br><span class="line">    ds,</span><br><span class="line">    x = <span class="string">&#x27;studentId&#x27;</span>,</span><br><span class="line">    y = <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">    title = <span class="string">&#x27;User action distribution&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show(<span class="string">&quot;svg&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/img/output_20_0.svg" /></p>
<h4 id="四个学校的人数占比">四个学校的人数占比</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ds = data[<span class="string">&#x27;MiddleSchoolId&#x27;</span>].value_counts().reset_index()</span><br><span class="line"></span><br><span class="line">ds.columns = [</span><br><span class="line">    <span class="string">&#x27;MiddleSchoolId&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;percent&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">ds[<span class="string">&#x27;percent&#x27;</span>] /= <span class="built_in">len</span>(data)</span><br><span class="line">ds = ds.sort_values([<span class="string">&#x27;percent&#x27;</span>])</span><br><span class="line"></span><br><span class="line">fig = px.pie(</span><br><span class="line">    ds,</span><br><span class="line">    names = <span class="string">&#x27;MiddleSchoolId&#x27;</span>,</span><br><span class="line">    values = <span class="string">&#x27;percent&#x27;</span>,</span><br><span class="line">    title = <span class="string">&#x27;Percent of schools&#x27;</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show(<span class="string">&quot;svg&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/img/output_22_0.svg" /></p>
<h4 id="学生答案正确的比例">学生答案正确的比例</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ds = data[<span class="string">&#x27;correct&#x27;</span>].value_counts().reset_index()</span><br><span class="line"></span><br><span class="line">ds.columns = [</span><br><span class="line">    <span class="string">&#x27;correct&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;percent&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">ds[<span class="string">&#x27;percent&#x27;</span>] /= <span class="built_in">len</span>(data)</span><br><span class="line">ds = ds.sort_values([<span class="string">&#x27;percent&#x27;</span>])</span><br><span class="line"></span><br><span class="line">fig = px.pie(</span><br><span class="line">    ds,</span><br><span class="line">    names = [<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>],</span><br><span class="line">    values = <span class="string">&#x27;percent&#x27;</span>,</span><br><span class="line">    title = <span class="string">&#x27;Percent of correct answers&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show(<span class="string">&quot;svg&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/img/output_24_0.svg" /></p>
<h4 id="被练习最多的题目id">被练习最多的题目id</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ds = data[<span class="string">&#x27;problemId&#x27;</span>].value_counts().reset_index()</span><br><span class="line"></span><br><span class="line">ds.columns = [</span><br><span class="line">    <span class="string">&#x27;problemId&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;count&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">ds[<span class="string">&#x27;problemId&#x27;</span>] = ds[<span class="string">&#x27;problemId&#x27;</span>].astype(<span class="built_in">str</span>) + <span class="string">&#x27;-&#x27;</span></span><br><span class="line">ds = ds.sort_values([<span class="string">&#x27;count&#x27;</span>]).tail(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">fig = px.bar(</span><br><span class="line">    ds,</span><br><span class="line">    x = <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">    y = <span class="string">&#x27;problemId&#x27;</span>,</span><br><span class="line">    orientation = <span class="string">&#x27;h&#x27;</span>,</span><br><span class="line">    title = <span class="string">&#x27;Top 40 useful problem ids&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show(<span class="string">&quot;svg&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/img/output_26_0.svg" /></p>
<h4 id="每个习题被测试的次数">每个习题被测试的次数</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ds = data[<span class="string">&#x27;problemId&#x27;</span>].value_counts().reset_index()</span><br><span class="line"></span><br><span class="line">ds.columns = [</span><br><span class="line">    <span class="string">&#x27;problemId&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;count&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">ds = ds.sort_values(<span class="string">&#x27;problemId&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fig = px.histogram(</span><br><span class="line">    ds,</span><br><span class="line">    x=<span class="string">&#x27;problemId&#x27;</span>,</span><br><span class="line">    y=<span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">    title=<span class="string">&#x27;problemid action distribution&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show(<span class="string">&quot;svg&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/img/output_28_0.svg" /></p>
<h4 id="题目类型的占比">题目类型的占比</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ds = data[<span class="string">&#x27;problemType&#x27;</span>].value_counts().reset_index()</span><br><span class="line"></span><br><span class="line">ds.columns = [</span><br><span class="line">    <span class="string">&#x27;problemType&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;percent&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">ds[<span class="string">&#x27;percent&#x27;</span>] /= <span class="built_in">len</span>(data)</span><br><span class="line">ds = ds.sort_values([<span class="string">&#x27;percent&#x27;</span>])</span><br><span class="line"></span><br><span class="line">fig = px.pie(</span><br><span class="line">    ds,</span><br><span class="line">    names = <span class="string">&#x27;problemType&#x27;</span>,</span><br><span class="line">    values = <span class="string">&#x27;percent&#x27;</span>,</span><br><span class="line">    title = <span class="string">&#x27;Percent of problem types&#x27;</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show(<span class="string">&quot;svg&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/img/output_30_0.svg" /></p>
<h4 id="被测试最多的6个题的正确率">被测试最多的6个题的正确率</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">ds = ds.sort_values([<span class="string">&#x27;percent&#x27;</span>]).tail(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">fig = make_subplots(rows=<span class="number">3</span>, cols=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">traces = [</span><br><span class="line">    go.Bar(</span><br><span class="line">        x = [<span class="string">&#x27;wrong&#x27;</span>, <span class="string">&#x27;right&#x27;</span>],</span><br><span class="line">        y = [</span><br><span class="line">            <span class="built_in">len</span>(data[(data[<span class="string">&#x27;problemType&#x27;</span>] == item) &amp; (data[<span class="string">&#x27;correct&#x27;</span>] == <span class="number">0</span>)]),</span><br><span class="line">            <span class="built_in">len</span>(data[(data[<span class="string">&#x27;problemType&#x27;</span>] == item) &amp; (data[<span class="string">&#x27;correct&#x27;</span>] == <span class="number">1</span>)])</span><br><span class="line">        ],</span><br><span class="line">        name = <span class="string">&#x27;Type: &#x27;</span> + <span class="built_in">str</span>(item),</span><br><span class="line">        text = [</span><br><span class="line">            <span class="built_in">str</span>(<span class="built_in">round</span>(<span class="number">100</span>*<span class="built_in">len</span>(data[(data[<span class="string">&#x27;problemType&#x27;</span>] == item)&amp;(data[<span class="string">&#x27;correct&#x27;</span>] == <span class="number">0</span>)])/<span class="built_in">len</span>(data[data[<span class="string">&#x27;problemType&#x27;</span>] == item]),<span class="number">2</span>)) + <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">            <span class="built_in">str</span>(<span class="built_in">round</span>(<span class="number">100</span>*<span class="built_in">len</span>(data[(data[<span class="string">&#x27;problemType&#x27;</span>] == item)&amp;(data[<span class="string">&#x27;correct&#x27;</span>] == <span class="number">1</span>)])/<span class="built_in">len</span>(data[data[<span class="string">&#x27;problemType&#x27;</span>] == item]),<span class="number">2</span>)) + <span class="string">&#x27;%&#x27;</span></span><br><span class="line">        ],</span><br><span class="line">        textposition = <span class="string">&#x27;auto&#x27;</span></span><br><span class="line">    ) <span class="keyword">for</span> item <span class="keyword">in</span> ds[<span class="string">&#x27;problemType&#x27;</span>].unique().tolist()</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(traces)):</span><br><span class="line">    fig.append_trace(</span><br><span class="line">        traces[i],</span><br><span class="line">        (i //<span class="number">2</span>) + <span class="number">1</span>,</span><br><span class="line">        (i % <span class="number">2</span>) + <span class="number">1</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    title_text = <span class="string">&#x27;Percent of correct answers for top 6 problem type&#x27;</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show(<span class="string">&quot;svg&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/img/output_32_0.svg" /></p>
<h4 id="题目中最常出现的40个技能">题目中最常出现的40个技能</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ds = data[<span class="string">&#x27;skill&#x27;</span>].dropna() <span class="comment"># There are less NaNs in &#x27;skill_id&#x27; column than &#x27;skill_name&#x27; column.</span></span><br><span class="line">ds = ds.value_counts().reset_index()</span><br><span class="line"></span><br><span class="line">ds.columns = [</span><br><span class="line">    <span class="string">&#x27;skill&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;count&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">ds[<span class="string">&#x27;skill&#x27;</span>] = ds[<span class="string">&#x27;skill&#x27;</span>].astype(<span class="built_in">str</span>) + <span class="string">&#x27;-&#x27;</span></span><br><span class="line">ds = ds.sort_values([<span class="string">&#x27;count&#x27;</span>]).tail(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">fig = px.bar(</span><br><span class="line">    ds,</span><br><span class="line">    x = <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">    y = <span class="string">&#x27;skill&#x27;</span>,</span><br><span class="line">    orientation = <span class="string">&#x27;h&#x27;</span>,</span><br><span class="line">    title = <span class="string">&#x27;Top 40 useful skills&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show(<span class="string">&quot;svg&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/img/output_34_0.svg" /></p>
<h2 id="数据清洗预处理">数据清洗（预处理）</h2>
<h3 id="特征选择选择子集">特征选择（选择子集）</h3>
<p>读取数据，将csv转成python的pandas数据类型，取出对研究有意义的变量：'startTime', 'timeTaken', 'studentId', 'skill', 'problemId', 'correct'，即时间，学生，技能，题目和正误信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tqdm</span><br><span class="line">data = pd.read_csv(<span class="string">&#x27;anonymized_full_release_competition_dataset.csv&#x27;</span>,</span><br><span class="line">    usecols=[<span class="string">&#x27;startTime&#x27;</span>, <span class="string">&#x27;timeTaken&#x27;</span>, <span class="string">&#x27;studentId&#x27;</span>, <span class="string">&#x27;skill&#x27;</span>, <span class="string">&#x27;problemId&#x27;</span>, <span class="string">&#x27;correct&#x27;</span>]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="缺失值处理">缺失值处理</h3>
<p>在前面缺失值处发现学生和时间没有缺失值，所以去除掉含有空的skill和problem的数据项</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = data.dropna(subset=[<span class="string">&#x27;skill&#x27;</span>, <span class="string">&#x27;problemId&#x27;</span>])</span><br></pre></td></tr></table></figure>
<h3 id="数据排序">数据排序</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data = data.sort_values(<span class="string">&#x27;startTime&#x27;</span>)</span><br><span class="line">data.timeTaken = data.timeTaken.astype(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># data = pd.read_csv(&#x27;anonymized_full_release_competition_dataset.csv&#x27;,</span></span><br><span class="line"><span class="comment">#     usecols=[&#x27;startTime&#x27;, &#x27;timeTaken&#x27;, &#x27;studentId&#x27;, &#x27;skill&#x27;, &#x27;problemId&#x27;, &#x27;correct&#x27;]</span></span><br><span class="line"><span class="comment"># ).dropna(subset=[&#x27;skill&#x27;, &#x27;problemId&#x27;]).sort_values(&#x27;startTime&#x27;)</span></span><br></pre></td></tr></table></figure>
<h2 id="构建模型">构建模型</h2>
<h3 id="变量变换">变量变换</h3>
<p>获得skill，problem和每条记录题目的耗时（秒）的序列（不重复）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">skills = data.skill.unique().tolist()</span><br><span class="line">problems = data.problemId.unique().tolist()</span><br><span class="line">at = data.timeTaken.unique()</span><br><span class="line"></span><br><span class="line"><span class="comment"># question id from 1 to #num_skill</span></span><br><span class="line">skill2id = &#123; p: i+<span class="number">1</span> <span class="keyword">for</span> i, p <span class="keyword">in</span> <span class="built_in">enumerate</span>(skills) &#125;</span><br><span class="line">problem2id = &#123; p: i+<span class="number">1</span> <span class="keyword">for</span> i, p <span class="keyword">in</span> <span class="built_in">enumerate</span>(problems) &#125;</span><br><span class="line">at2id = &#123; a: i <span class="keyword">for</span> i, a <span class="keyword">in</span> <span class="built_in">enumerate</span>(at) &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;number of skills: %d&quot;</span> % <span class="built_in">len</span>(skills))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;number of problems: %d&quot;</span> % <span class="built_in">len</span>(problems))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;number of answer time: %d&quot;</span> % <span class="built_in">len</span>(at))</span><br></pre></td></tr></table></figure>
<pre><code>number of skills: 102
number of problems: 3162
number of answer time: 1326</code></pre>
<p>将做题时间间隔离散为分钟，所有超过一个月的间隔时间设置为一个月。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">it = <span class="built_in">set</span>()</span><br><span class="line"><span class="comment"># calculate interval time</span></span><br><span class="line"><span class="keyword">for</span> u <span class="keyword">in</span> data.studentId.unique():</span><br><span class="line">    startTime = np.array(data[data.studentId == u].startTime)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(startTime)):</span><br><span class="line">        item = (startTime[i] - startTime[i - <span class="number">1</span>]) // <span class="number">60</span></span><br><span class="line">        <span class="keyword">if</span> item &gt; <span class="number">43200</span>:</span><br><span class="line">            item = <span class="number">43200</span></span><br><span class="line">        it.add(item)</span><br><span class="line"></span><br><span class="line">it2id = &#123; a: i <span class="keyword">for</span> i, a <span class="keyword">in</span> <span class="built_in">enumerate</span>(it) &#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;number of interval time: %d&quot;</span> % <span class="built_in">len</span>(it))</span><br></pre></td></tr></table></figure>
<pre><code>number of interval time: 2839</code></pre>
<p>构建习题和技能的矩阵（称为Q矩阵</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># problems to skills</span></span><br><span class="line">problem2skill = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> s, p <span class="keyword">in</span> <span class="built_in">zip</span>(np.array(data.skill), np.array(data.problemId)):</span><br><span class="line">    problem2skill[problem2id[p]] = skill2id[s]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;../../data/anonymized_full_release_competition_dataset/problem2skill&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(problem2skill))</span><br></pre></td></tr></table></figure>
<p>构建每个学生的习题序列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_all_seq</span>(<span class="params">students</span>):</span></span><br><span class="line">    all_sequences = []</span><br><span class="line">    <span class="keyword">for</span> student_id <span class="keyword">in</span> tqdm.tqdm(students, <span class="string">&#x27;parse student sequence:\t&#x27;</span>):</span><br><span class="line">        student_sequence = parse_student_seq(data[data.studentId == student_id])</span><br><span class="line">        all_sequences.extend([student_sequence])</span><br><span class="line">    <span class="keyword">return</span> all_sequences</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_student_seq</span>(<span class="params">student</span>):</span></span><br><span class="line">    seq = student</span><br><span class="line">    s = [skill2id[q] <span class="keyword">for</span> q <span class="keyword">in</span> seq.skill.tolist()]</span><br><span class="line">    a = seq.correct.tolist()</span><br><span class="line">    p = [problem2id[p] <span class="keyword">for</span> p <span class="keyword">in</span> seq.problemId.tolist()]</span><br><span class="line">    it = [<span class="number">0</span>]</span><br><span class="line">    startTime = np.array(seq.startTime)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(startTime)):</span><br><span class="line">        item = (startTime[i] - startTime[i - <span class="number">1</span>]) // <span class="number">60</span></span><br><span class="line">        <span class="keyword">if</span> item &gt; <span class="number">43200</span>:</span><br><span class="line">            item = <span class="number">43200</span></span><br><span class="line">        it.append(it2id[item])</span><br><span class="line">    at = [at2id[<span class="built_in">int</span>(x)] <span class="keyword">for</span> x <span class="keyword">in</span> seq.timeTaken.tolist()]</span><br><span class="line">    <span class="keyword">return</span> s, a, p, it, at</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sequences = parse_all_seq(data.studentId.unique())</span><br></pre></td></tr></table></figure>
<pre><code>parse student sequence: : 100%|██████████| 1709/1709 [00:03&lt;00:00, 435.26it/s]</code></pre>
<h3 id="划分训练集和测试集">划分训练集和测试集</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split, KFold</span><br><span class="line"></span><br><span class="line"><span class="comment"># split train data and test data</span></span><br><span class="line">train_data, test_data = train_test_split(sequences, test_size=<span class="number">.2</span>, random_state=<span class="number">10</span>)</span><br><span class="line">train_data = np.array(train_data)</span><br><span class="line">test_data = np.array(test_data)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;ipython-input-23-2e004a82d1e4&gt;:5: VisibleDeprecationWarning:

Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray.

&lt;ipython-input-23-2e004a82d1e4&gt;:6: VisibleDeprecationWarning:

Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray.</code></pre>
<h3 id="保存至txt">保存至txt</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sequences2l</span>(<span class="params">sequences, trg_path</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(trg_path, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> seq <span class="keyword">in</span> tqdm.tqdm(sequences, <span class="string">&#x27;write data into file: %s&#x27;</span> % trg_path):</span><br><span class="line">            s_seq, a_seq, p_seq, it_seq, at_seq = seq</span><br><span class="line">            seq_len = <span class="built_in">len</span>(s_seq)</span><br><span class="line">            f.write(<span class="built_in">str</span>(seq_len) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            f.write(<span class="string">&#x27;,&#x27;</span>.join([<span class="built_in">str</span>(s) <span class="keyword">for</span> s <span class="keyword">in</span> s_seq]) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            f.write(<span class="string">&#x27;,&#x27;</span>.join([<span class="built_in">str</span>(a) <span class="keyword">for</span> a <span class="keyword">in</span> a_seq]) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            f.write(<span class="string">&#x27;,&#x27;</span>.join([<span class="built_in">str</span>(p) <span class="keyword">for</span> p <span class="keyword">in</span> p_seq]) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            f.write(<span class="string">&#x27;,&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> it_seq]) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            f.write(<span class="string">&#x27;,&#x27;</span>.join([<span class="built_in">str</span>(a) <span class="keyword">for</span> a <span class="keyword">in</span> at_seq]) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># split into 5 folds</span></span><br><span class="line">kfold = KFold(n_splits=<span class="number">5</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">10</span>)</span><br><span class="line">idx = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> train_data_1, valid_data <span class="keyword">in</span> kfold.split(train_data):</span><br><span class="line">    sequences2l(train_data[train_data_1], <span class="string">&#x27;./dataset/train&#x27;</span> + <span class="built_in">str</span>(idx) + <span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line">    sequences2l(train_data[valid_data], <span class="string">&#x27;./dataset/valid&#x27;</span> + <span class="built_in">str</span>(idx) + <span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line">    idx += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">sequences2l(test_data, <span class="string">&#x27;./dataset/test.txt&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>write data into file: ./dataset/train0.txt: 100%|██████████| 1093/1093 [00:00&lt;00:00, 1715.79it/s]
write data into file: ./dataset/valid0.txt: 100%|██████████| 274/274 [00:00&lt;00:00, 2458.13it/s]
write data into file: ./dataset/train1.txt: 100%|██████████| 1093/1093 [00:00&lt;00:00, 2091.07it/s]
write data into file: ./dataset/valid1.txt: 100%|██████████| 274/274 [00:00&lt;00:00, 2126.56it/s]
write data into file: ./dataset/train2.txt: 100%|██████████| 1094/1094 [00:00&lt;00:00, 2146.95it/s]
write data into file: ./dataset/valid2.txt: 100%|██████████| 273/273 [00:00&lt;00:00, 2281.48it/s]
write data into file: ./dataset/train3.txt: 100%|██████████| 1094/1094 [00:00&lt;00:00, 1977.62it/s]
write data into file: ./dataset/valid3.txt: 100%|██████████| 273/273 [00:00&lt;00:00, 1456.54it/s]
write data into file: ./dataset/train4.txt: 100%|██████████| 1094/1094 [00:00&lt;00:00, 1845.52it/s]
write data into file: ./dataset/valid4.txt: 100%|██████████| 273/273 [00:00&lt;00:00, 1751.91it/s]
write data into file: ./dataset/test.txt: 100%|██████████| 342/342 [00:00&lt;00:00, 2024.49it/s]</code></pre>
<h3 id="超参数定义">超参数定义</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> load_data <span class="keyword">import</span> DATA</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_q_matrix</span>(<span class="params">path, n_skill, n_problem, gamma=<span class="number">0</span></span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            problem2skill = <span class="built_in">eval</span>(line)</span><br><span class="line">    q_matrix = np.zeros((n_problem + <span class="number">1</span>, n_skill + <span class="number">1</span>)) + gamma</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> problem2skill.keys():</span><br><span class="line">        q_matrix[p][problem2skill[p]] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> q_matrix</span><br><span class="line"></span><br><span class="line">batch_size = <span class="number">32</span></span><br><span class="line">n_at = <span class="number">1326</span></span><br><span class="line">n_it = <span class="number">2839</span></span><br><span class="line">n_question = <span class="number">102</span></span><br><span class="line">n_exercise = <span class="number">3162</span></span><br><span class="line">seqlen = <span class="number">500</span></span><br><span class="line">d_k = <span class="number">128</span></span><br><span class="line">d_a = <span class="number">50</span></span><br><span class="line">d_e = <span class="number">128</span></span><br><span class="line">q_gamma = <span class="number">0.03</span></span><br><span class="line">dropout = <span class="number">0.2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="选择算法">选择算法</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LPKTNet</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n_at, n_it, n_exercise, n_question, d_a, d_e, d_k, q_matrix, dropout=<span class="number">0.2</span></span>):</span></span><br><span class="line">        <span class="built_in">super</span>(LPKTNet, self).__init__()</span><br><span class="line">        self.d_k = d_k</span><br><span class="line">        self.d_a = d_a</span><br><span class="line">        self.d_e = d_e</span><br><span class="line">        self.q_matrix = q_matrix</span><br><span class="line">        self.n_question = n_question</span><br><span class="line"></span><br><span class="line">        self.at_embed = nn.Embedding(n_at + <span class="number">10</span>, d_k)</span><br><span class="line">        torch.nn.init.xavier_normal_(self.at_embed.weight)</span><br><span class="line">        self.it_embed = nn.Embedding(n_it + <span class="number">10</span>, d_k)</span><br><span class="line">        torch.nn.init.xavier_normal_(self.it_embed.weight)</span><br><span class="line">        self.e_embed = nn.Embedding(n_exercise + <span class="number">10</span>, d_k)</span><br><span class="line">        torch.nn.init.xavier_normal_(self.e_embed.weight)</span><br><span class="line"></span><br><span class="line">        self.linear_1 = nn.Linear(d_a + d_e + d_k, d_k)</span><br><span class="line">        torch.nn.init.xavier_normal_(self.linear_1.weight)</span><br><span class="line">        self.linear_2 = nn.Linear(<span class="number">4</span> * d_k, d_k)</span><br><span class="line">        torch.nn.init.xavier_normal_(self.linear_2.weight)</span><br><span class="line">        self.linear_3 = nn.Linear(<span class="number">4</span> * d_k, d_k)</span><br><span class="line">        torch.nn.init.xavier_normal_(self.linear_3.weight)</span><br><span class="line">        self.linear_4 = nn.Linear(<span class="number">3</span> * d_k, d_k)</span><br><span class="line">        torch.nn.init.xavier_normal_(self.linear_4.weight)</span><br><span class="line">        self.linear_5 = nn.Linear(d_e + d_k, d_k)</span><br><span class="line">        torch.nn.init.xavier_normal_(self.linear_5.weight)</span><br><span class="line"></span><br><span class="line">        self.tanh = nn.Tanh()</span><br><span class="line">        self.sig = nn.Sigmoid()</span><br><span class="line">        self.dropout = nn.Dropout(dropout)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, e_data, at_data, a_data, it_data</span>):</span></span><br><span class="line">        batch_size, seq_len = e_data.size(<span class="number">0</span>), e_data.size(<span class="number">1</span>)</span><br><span class="line">        e_embed_data = self.e_embed(e_data)</span><br><span class="line">        at_embed_data = self.at_embed(at_data)</span><br><span class="line">        it_embed_data = self.it_embed(it_data)</span><br><span class="line">        a_data = a_data.view(-<span class="number">1</span>, <span class="number">1</span>).repeat(<span class="number">1</span>, self.d_a).view(batch_size, -<span class="number">1</span>, self.d_a)</span><br><span class="line">        h_pre = nn.init.xavier_normal_(torch.zeros(self.n_question + <span class="number">1</span>, self.d_k)).repeat(batch_size, <span class="number">1</span>, <span class="number">1</span>).to(device)</span><br><span class="line">        h_tilde_pre = <span class="literal">None</span></span><br><span class="line">        all_learning = self.linear_1(torch.cat((e_embed_data, at_embed_data, a_data), <span class="number">2</span>))</span><br><span class="line">        learning_pre = torch.zeros(batch_size, self.d_k).to(device)</span><br><span class="line"></span><br><span class="line">        pred = torch.zeros(batch_size, seq_len).to(device)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, seq_len - <span class="number">1</span>):</span><br><span class="line">            e = e_data[:, t]</span><br><span class="line">            <span class="comment"># q_e: (bs, 1, n_skill)</span></span><br><span class="line">            q_e = self.q_matrix[e].view(batch_size, <span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line">            it = it_embed_data[:, t]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Learning Module</span></span><br><span class="line">            <span class="keyword">if</span> h_tilde_pre <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                h_tilde_pre = q_e.bmm(h_pre).view(batch_size, self.d_k)</span><br><span class="line">            learning = all_learning[:, t]</span><br><span class="line">            learning_gain = self.linear_2(torch.cat((learning_pre, it, learning, h_tilde_pre), <span class="number">1</span>))</span><br><span class="line">            learning_gain = self.tanh(learning_gain)</span><br><span class="line">            gamma_l = self.linear_3(torch.cat((learning_pre, it, learning, h_tilde_pre), <span class="number">1</span>))</span><br><span class="line">            gamma_l = self.sig(gamma_l)</span><br><span class="line">            LG = gamma_l * ((learning_gain + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">            LG_tilde = self.dropout(q_e.transpose(<span class="number">1</span>, <span class="number">2</span>).bmm(LG.view(batch_size, <span class="number">1</span>, -<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Forgetting Module</span></span><br><span class="line">            <span class="comment"># h_pre: (bs, n_skill, d_k)</span></span><br><span class="line">            <span class="comment"># LG: (bs, d_k)</span></span><br><span class="line">            <span class="comment"># it: (bs, d_k)</span></span><br><span class="line">            n_skill = LG_tilde.size(<span class="number">1</span>)</span><br><span class="line">            gamma_f = self.sig(self.linear_4(torch.cat((</span><br><span class="line">                h_pre,</span><br><span class="line">                LG.repeat(<span class="number">1</span>, n_skill).view(batch_size, -<span class="number">1</span>, self.d_k),</span><br><span class="line">                it.repeat(<span class="number">1</span>, n_skill).view(batch_size, -<span class="number">1</span>, self.d_k)</span><br><span class="line">            ), <span class="number">2</span>)))</span><br><span class="line">            h = LG_tilde + gamma_f * h_pre</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Predicting Module</span></span><br><span class="line">            h_tilde = self.q_matrix[e_data[:, t + <span class="number">1</span>]].view(batch_size, <span class="number">1</span>, -<span class="number">1</span>).bmm(h).view(batch_size, self.d_k)</span><br><span class="line">            y = self.sig(self.linear_5(torch.cat((e_embed_data[:, t + <span class="number">1</span>], h_tilde), <span class="number">1</span>))).<span class="built_in">sum</span>(<span class="number">1</span>) / self.d_k</span><br><span class="line">            pred[:, t + <span class="number">1</span>] = y</span><br><span class="line"></span><br><span class="line">            <span class="comment"># prepare for next prediction</span></span><br><span class="line">            learning_pre = learning</span><br><span class="line">            h_pre = h</span><br><span class="line">            h_tilde_pre = h_tilde</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pred</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics</span><br><span class="line"><span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">binary_entropy</span>(<span class="params">target, pred</span>):</span></span><br><span class="line">    loss = target * np.log(np.maximum(<span class="number">1e-10</span>, pred)) + (<span class="number">1.0</span> - target) * np.log(np.maximum(<span class="number">1e-10</span>, <span class="number">1.0</span> - pred))</span><br><span class="line">    <span class="keyword">return</span> np.average(loss) * -<span class="number">1.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_auc</span>(<span class="params">all_target, all_pred</span>):</span></span><br><span class="line">    <span class="keyword">return</span> metrics.roc_auc_score(all_target, all_pred)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_accuracy</span>(<span class="params">all_target, all_pred</span>):</span></span><br><span class="line">    all_pred[all_pred &gt; <span class="number">0.5</span>] = <span class="number">1.0</span></span><br><span class="line">    all_pred[all_pred &lt;= <span class="number">0.5</span>] = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">return</span> metrics.accuracy_score(all_target, all_pred)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train_one_epoch</span>(<span class="params">net, optimizer, criterion, batch_size, a_data, e_data, it_data, at_data</span>):</span></span><br><span class="line">    net.train()</span><br><span class="line">    n = <span class="built_in">int</span>(math.ceil(<span class="built_in">len</span>(e_data) / batch_size))</span><br><span class="line">    shuffled_ind = np.arange(e_data.shape[<span class="number">0</span>])</span><br><span class="line">    np.random.shuffle(shuffled_ind)</span><br><span class="line">    e_data = e_data[shuffled_ind]</span><br><span class="line">    at_data = at_data[shuffled_ind]</span><br><span class="line">    a_data = a_data[shuffled_ind]</span><br><span class="line">    it_data = it_data[shuffled_ind]</span><br><span class="line"></span><br><span class="line">    pred_list = []</span><br><span class="line">    target_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> tqdm.tqdm(<span class="built_in">range</span>(n), <span class="string">&#x27;Training&#x27;</span>):</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line"></span><br><span class="line">        e_one_seq = e_data[idx * batch_size: (idx + <span class="number">1</span>) * batch_size, :]</span><br><span class="line">        at_one_seq = at_data[idx * batch_size: (idx + <span class="number">1</span>) * batch_size, :]</span><br><span class="line">        a_one_seq = a_data[idx * batch_size: (idx + <span class="number">1</span>) * batch_size, :]</span><br><span class="line">        it_one_seq = it_data[idx * batch_size: (idx + <span class="number">1</span>) * batch_size, :]</span><br><span class="line"></span><br><span class="line">        input_e = torch.from_numpy(e_one_seq).long().to(device)</span><br><span class="line">        input_at = torch.from_numpy(at_one_seq).long().to(device)</span><br><span class="line">        input_it = torch.from_numpy(it_one_seq).long().to(device)</span><br><span class="line">        target = torch.from_numpy(a_one_seq).<span class="built_in">float</span>().to(device)</span><br><span class="line"></span><br><span class="line">        pred = net(input_e, input_at, target, input_it)</span><br><span class="line"></span><br><span class="line">        mask = input_e[:, <span class="number">1</span>:] &gt; <span class="number">0</span></span><br><span class="line">        masked_pred = pred[:, <span class="number">1</span>:][mask]</span><br><span class="line">        masked_truth = target[:, <span class="number">1</span>:][mask]</span><br><span class="line"></span><br><span class="line">        loss = criterion(masked_pred, masked_truth).<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        masked_pred = masked_pred.detach().cpu().numpy()</span><br><span class="line">        masked_truth = masked_truth.detach().cpu().numpy()</span><br><span class="line"></span><br><span class="line">        pred_list.append(masked_pred)</span><br><span class="line">        target_list.append(masked_truth)</span><br><span class="line"></span><br><span class="line">    all_pred = np.concatenate(pred_list, axis=<span class="number">0</span>)</span><br><span class="line">    all_target = np.concatenate(target_list, axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    loss = binary_entropy(all_target, all_pred)</span><br><span class="line">    auc = compute_auc(all_target, all_pred)</span><br><span class="line">    accuracy = compute_accuracy(all_target, all_pred)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> loss, auc, accuracy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_one_epoch</span>(<span class="params">net, batch_size, a_data, e_data, it_data, at_data</span>):</span></span><br><span class="line">    net.<span class="built_in">eval</span>()</span><br><span class="line">    n = <span class="built_in">int</span>(math.ceil(<span class="built_in">len</span>(e_data) / batch_size))</span><br><span class="line"></span><br><span class="line">    pred_list = []</span><br><span class="line">    target_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> tqdm.tqdm(<span class="built_in">range</span>(n), <span class="string">&#x27;Testing&#x27;</span>):</span><br><span class="line">        e_one_seq = e_data[idx * batch_size: (idx + <span class="number">1</span>) * batch_size, :]</span><br><span class="line">        at_one_seq = at_data[idx * batch_size: (idx + <span class="number">1</span>) * batch_size, :]</span><br><span class="line">        a_one_seq = a_data[idx * batch_size: (idx + <span class="number">1</span>) * batch_size, :]</span><br><span class="line">        it_one_seq = it_data[idx * batch_size: (idx + <span class="number">1</span>) * batch_size, :]</span><br><span class="line"></span><br><span class="line">        input_e = torch.from_numpy(e_one_seq).long().to(device)</span><br><span class="line">        input_at = torch.from_numpy(at_one_seq).long().to(device)</span><br><span class="line">        input_it = torch.from_numpy(it_one_seq).long().to(device)</span><br><span class="line">        target = torch.from_numpy(a_one_seq).<span class="built_in">float</span>().to(device)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">            pred = net(input_e, input_at, target, input_it)</span><br><span class="line"></span><br><span class="line">            mask = input_e[:, <span class="number">1</span>:] &gt; <span class="number">0</span></span><br><span class="line">            masked_pred = pred[:, <span class="number">1</span>:][mask].detach().cpu().numpy()</span><br><span class="line">            masked_truth = target[:, <span class="number">1</span>:][mask].detach().cpu().numpy()</span><br><span class="line"></span><br><span class="line">            pred_list.append(masked_pred)</span><br><span class="line">            target_list.append(masked_truth)</span><br><span class="line"></span><br><span class="line">    all_pred = np.concatenate(pred_list, axis=<span class="number">0</span>)</span><br><span class="line">    all_target = np.concatenate(target_list, axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    loss = binary_entropy(all_target, all_pred)</span><br><span class="line">    auc = compute_auc(all_target, all_pred)</span><br><span class="line">    accuracy = compute_accuracy(all_target, all_pred)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> loss, auc, accuracy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LPKT</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n_at, n_it, n_exercise, n_question, d_a, d_e, d_k, q_matrix, batch_size, dropout=<span class="number">0.2</span></span>):</span></span><br><span class="line">        <span class="built_in">super</span>(LPKT, self).__init__()</span><br><span class="line">        q_matrix = torch.from_numpy(q_matrix).<span class="built_in">float</span>().to(device)</span><br><span class="line">        self.lpkt_net = LPKTNet(n_at, n_it, n_exercise, n_question, d_a, d_e, d_k, q_matrix, dropout).to(device)</span><br><span class="line">        self.batch_size = batch_size</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">train</span>(<span class="params">self, train_data, test_data=<span class="literal">None</span>, *, epoch: <span class="built_in">int</span>, lr=<span class="number">0.002</span>, lr_decay_step=<span class="number">15</span>, lr_decay_rate=<span class="number">0.5</span></span>) -&gt; ...:</span></span><br><span class="line">        optimizer = torch.optim.Adam(self.lpkt_net.parameters(), lr=lr, eps=<span class="number">1e-8</span>, betas=(<span class="number">0.1</span>, <span class="number">0.999</span>), weight_decay=<span class="number">1e-6</span>)</span><br><span class="line">        scheduler = torch.optim.lr_scheduler.StepLR(optimizer, lr_decay_step, gamma=lr_decay_rate)</span><br><span class="line">        criterion = nn.BCELoss(reduction=<span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">        best_train_auc, best_test_auc = <span class="number">.0</span>, <span class="number">.0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(epoch):</span><br><span class="line">            train_loss, train_auc, train_accuracy = train_one_epoch(self.lpkt_net, optimizer, criterion,</span><br><span class="line">                                                                    self.batch_size, *train_data)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[Epoch %d] LogisticLoss: %.6f&quot;</span> % (idx, train_loss))</span><br><span class="line">            <span class="keyword">if</span> train_auc &gt; best_train_auc:</span><br><span class="line">                best_train_auc = train_auc</span><br><span class="line"></span><br><span class="line">            scheduler.step()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> test_data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                test_loss, test_auc, test_accuracy = self.<span class="built_in">eval</span>(test_data)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[Epoch %d] auc: %.6f, accuracy: %.6f&quot;</span> % (idx, test_auc, test_accuracy))</span><br><span class="line">                <span class="keyword">if</span> test_auc &gt; best_test_auc:</span><br><span class="line">                    best_test_auc = test_auc</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> best_train_auc, best_test_auc</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eval</span>(<span class="params">self, test_data</span>) -&gt; ...:</span></span><br><span class="line">        self.lpkt_net.<span class="built_in">eval</span>()</span><br><span class="line">        <span class="keyword">return</span> test_one_epoch(self.lpkt_net, self.batch_size, *test_data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save</span>(<span class="params">self, filepath</span>) -&gt; ...:</span></span><br><span class="line">        torch.save(self.lpkt_net.state_dict(), filepath)</span><br><span class="line">        logging.info(<span class="string">&quot;save parameters to %s&quot;</span> % filepath)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">load</span>(<span class="params">self, filepath</span>) -&gt; ...:</span></span><br><span class="line">        self.lpkt_net.load_state_dict(torch.load(filepath))</span><br><span class="line">        logging.info(<span class="string">&quot;load parameters from %s&quot;</span> % filepath)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="训练模型">训练模型</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">dat = DATA(seqlen=seqlen, separate_char=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">test_data = dat.load_data(<span class="string">&#x27;../../data/anonymized_full_release_competition_dataset/test.txt&#x27;</span>)</span><br><span class="line">q_matrix = generate_q_matrix(</span><br><span class="line">    <span class="string">&#x27;../../data/anonymized_full_release_competition_dataset/problem2skill&#x27;</span>,</span><br><span class="line">    n_question, n_exercise,</span><br><span class="line">    q_gamma</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    train_data = dat.load_data(<span class="string">&#x27;../../data/anonymized_full_release_competition_dataset/train&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    lpkt = LPKT(n_at, n_it, n_exercise, n_question, d_a, d_e, d_k, q_matrix, batch_size, dropout)</span><br><span class="line">    lpkt.train(train_data, test_data, epoch=<span class="number">2</span>, lr=<span class="number">0.003</span>)</span><br><span class="line">    lpkt.save(<span class="string">&quot;lpkt.params&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    lpkt.load(<span class="string">&quot;lpkt.params&quot;</span>)</span><br><span class="line">    _, auc, accuracy = lpkt.<span class="built_in">eval</span>(test_data)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;auc: %.6f, accuracy: %.6f&quot;</span> % (auc, accuracy))</span><br></pre></td></tr></table></figure>
<pre><code>0

Training: 100%|██████████| 112/112 [49:53&lt;00:00, 26.72s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 0] LogisticLoss: 0.584297


Testing: 100%|██████████| 35/35 [02:38&lt;00:00,  4.52s/it]
Training:   0%|          | 0/112 [00:00&lt;?, ?it/s]

[Epoch 0] auc: 0.773265, accuracy: 0.721562


Training: 100%|██████████| 112/112 [49:01&lt;00:00, 26.26s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] LogisticLoss: 0.533850


Testing: 100%|██████████| 35/35 [02:17&lt;00:00,  3.93s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] auc: 0.786359, accuracy: 0.730012


Testing: 100%|██████████| 35/35 [02:06&lt;00:00,  3.63s/it]


auc: 0.786361, accuracy: 0.729996

1


Training: 100%|██████████| 112/112 [45:56&lt;00:00, 24.61s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 0] LogisticLoss: 0.582626


Testing: 100%|██████████| 35/35 [02:07&lt;00:00,  3.65s/it]
Training:   0%|          | 0/112 [00:00&lt;?, ?it/s]

[Epoch 0] auc: 0.773794, accuracy: 0.720361


Training: 100%|██████████| 112/112 [43:30&lt;00:00, 23.31s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] LogisticLoss: 0.534546


Testing: 100%|██████████| 35/35 [02:04&lt;00:00,  3.56s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] auc: 0.785977, accuracy: 0.729295


Testing: 100%|██████████| 35/35 [02:01&lt;00:00,  3.46s/it]


auc: 0.785986, accuracy: 0.729273

2


Training: 100%|██████████| 111/111 [2:07:17&lt;00:00, 68.80s/it]   
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 0] LogisticLoss: 0.589352


Testing: 100%|██████████| 35/35 [02:58&lt;00:00,  5.10s/it]
Training:   0%|          | 0/111 [00:00&lt;?, ?it/s]

[Epoch 0] auc: 0.767267, accuracy: 0.716006


Training: 100%|██████████| 111/111 [40:08&lt;00:00, 21.69s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] LogisticLoss: 0.538547


Testing: 100%|██████████| 35/35 [01:55&lt;00:00,  3.31s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] auc: 0.784882, accuracy: 0.729502


Testing: 100%|██████████| 35/35 [01:56&lt;00:00,  3.33s/it]


auc: 0.784870, accuracy: 0.729491

3


Training: 100%|██████████| 111/111 [37:00&lt;00:00, 20.00s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 0] LogisticLoss: 0.586455


Testing: 100%|██████████| 35/35 [02:06&lt;00:00,  3.62s/it]
Training:   0%|          | 0/111 [00:00&lt;?, ?it/s]

[Epoch 0] auc: 0.764418, accuracy: 0.715741


Training: 100%|██████████| 111/111 [38:22&lt;00:00, 20.74s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] LogisticLoss: 0.533903


Testing: 100%|██████████| 35/35 [02:08&lt;00:00,  3.67s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] auc: 0.783817, accuracy: 0.728861


Testing: 100%|██████████| 35/35 [02:08&lt;00:00,  3.68s/it]


auc: 0.783823, accuracy: 0.728853

4


Training: 100%|██████████| 111/111 [43:06&lt;00:00, 23.31s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 0] LogisticLoss: 0.583719


Testing: 100%|██████████| 35/35 [03:00&lt;00:00,  5.16s/it]
Training:   0%|          | 0/111 [00:00&lt;?, ?it/s]

[Epoch 0] auc: 0.772723, accuracy: 0.721236


Training: 100%|██████████| 111/111 [45:19&lt;00:00, 24.50s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] LogisticLoss: 0.534575


Testing: 100%|██████████| 35/35 [02:11&lt;00:00,  3.77s/it]
Testing:   0%|          | 0/35 [00:00&lt;?, ?it/s]

[Epoch 1] auc: 0.786040, accuracy: 0.728837


Testing: 100%|██████████| 35/35 [02:10&lt;00:00,  3.74s/it]


auc: 0.786044, accuracy: 0.728773</code></pre>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>Post title：数据预处理</li>
        <li>Post author：Caaaaa</li>
        <li>Create time：2022-10-06 20:08:30</li>
        <li>
            Post link：https://caaaa-a.github.io/2022/10/06/python小记-数据处理与分析/
        </li>
        <li>
            Copyright Notice：All articles in this blog are licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> unless stating additionally.
        </li>
    </ul>
</div>

            </div>
        

        

        
            <div class="article-nav">
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2022/10/04/python%E5%B0%8F%E8%AE%B0-%20%E8%AE%BA%E6%96%87%E5%8A%A8%E8%AF%8D%E6%9F%A5%E6%89%BE/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">论文动词查找</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Caaaaa</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%88%86%E6%9E%90%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">定义分析的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%90%86%E8%A7%A3%E6%95%B0%E6%8D%AE"><span class="nav-text">理解数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="nav-text">导入数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E9%9B%86%E4%BF%A1%E6%81%AF"><span class="nav-text">查看数据集信息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%8C%87%E6%A0%87"><span class="nav-text">常见指标</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E9%87%8D%E5%A4%8D%E7%9A%84%E8%AE%B0%E5%BD%95%E6%95%B0"><span class="nav-text">不重复的记录数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AF%8F%E4%B8%80%E7%B1%BB%E7%9A%84%E7%BC%BA%E5%A4%B1%E5%80%BC%E6%AF%94%E4%BE%8B"><span class="nav-text">每一类的缺失值比例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E9%87%8D%E5%A4%8D%E7%9A%84%E5%AD%A6%E7%94%9F%E6%95%B0"><span class="nav-text">不重复的学生数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E9%87%8D%E5%A4%8D%E7%9A%84%E5%AD%A6%E6%A0%A1%E6%95%B0"><span class="nav-text">不重复的学校数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%E6%9C%80%E5%A4%9A%E7%9A%84%E5%AD%A6%E7%94%9F"><span class="nav-text">做题记录最多的学生</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AF%8F%E4%B8%AA%E5%AD%A6%E7%94%9F%E7%9A%84%E5%81%9A%E9%A2%98%E6%95%B0"><span class="nav-text">每个学生的做题数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9B%E4%B8%AA%E5%AD%A6%E6%A0%A1%E7%9A%84%E4%BA%BA%E6%95%B0%E5%8D%A0%E6%AF%94"><span class="nav-text">四个学校的人数占比</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%A6%E7%94%9F%E7%AD%94%E6%A1%88%E6%AD%A3%E7%A1%AE%E7%9A%84%E6%AF%94%E4%BE%8B"><span class="nav-text">学生答案正确的比例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A2%AB%E7%BB%83%E4%B9%A0%E6%9C%80%E5%A4%9A%E7%9A%84%E9%A2%98%E7%9B%AEid"><span class="nav-text">被练习最多的题目id</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AF%8F%E4%B8%AA%E4%B9%A0%E9%A2%98%E8%A2%AB%E6%B5%8B%E8%AF%95%E7%9A%84%E6%AC%A1%E6%95%B0"><span class="nav-text">每个习题被测试的次数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8D%A0%E6%AF%94"><span class="nav-text">题目类型的占比</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A2%AB%E6%B5%8B%E8%AF%95%E6%9C%80%E5%A4%9A%E7%9A%846%E4%B8%AA%E9%A2%98%E7%9A%84%E6%AD%A3%E7%A1%AE%E7%8E%87"><span class="nav-text">被测试最多的6个题的正确率</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E4%B8%AD%E6%9C%80%E5%B8%B8%E5%87%BA%E7%8E%B0%E7%9A%8440%E4%B8%AA%E6%8A%80%E8%83%BD"><span class="nav-text">题目中最常出现的40个技能</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E9%A2%84%E5%A4%84%E7%90%86"><span class="nav-text">数据清洗（预处理）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9%E9%80%89%E6%8B%A9%E5%AD%90%E9%9B%86"><span class="nav-text">特征选择（选择子集）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86"><span class="nav-text">缺失值处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8E%92%E5%BA%8F"><span class="nav-text">数据排序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9E%8B"><span class="nav-text">构建模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E5%8F%98%E6%8D%A2"><span class="nav-text">变量变换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%92%E5%88%86%E8%AE%AD%E7%BB%83%E9%9B%86%E5%92%8C%E6%B5%8B%E8%AF%95%E9%9B%86"><span class="nav-text">划分训练集和测试集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E8%87%B3txt"><span class="nav-text">保存至txt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B6%85%E5%8F%82%E6%95%B0%E5%AE%9A%E4%B9%89"><span class="nav-text">超参数定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E7%AE%97%E6%B3%95"><span class="nav-text">选择算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B"><span class="nav-text">训练模型</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script>






<div class="post-scripts">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script>
    
</div>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

</body>
</html>
